<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Amazon Web Services | A Collection of Python Examples</title>
  <meta name="description" content="Conda and git installations" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Amazon Web Services | A Collection of Python Examples" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Conda and git installations" />
  <meta name="github-repo" content="fanwangecon/R4Econ" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Amazon Web Services | A Collection of Python Examples" />
  
  <meta name="twitter:description" content="Conda and git installations" />
  

<meta name="author" content="Fan Wang" />


<meta name="date" content="2020-10-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tables-and-graphs.html"/>
<link rel="next" href="docker-container.html"/>
<script src="libs/header-attrs-2.4/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-92953468-11"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-92953468-11');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Collection of Python Examples</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html"><i class="fa fa-check"></i><b>1</b> Array, Matrix, Dataframe</a>
<ul>
<li class="chapter" data-level="1.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#array"><i class="fa fa-check"></i><b>1.1</b> Array</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#strings"><i class="fa fa-check"></i><b>1.1.1</b> Strings</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#dictionary"><i class="fa fa-check"></i><b>1.2</b> Dictionary</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#dictionary-1"><i class="fa fa-check"></i><b>1.2.1</b> Dictionary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html"><i class="fa fa-check"></i><b>2</b> Tables and Graphs</a>
<ul>
<li class="chapter" data-level="2.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#matplotlib-base-plots"><i class="fa fa-check"></i><b>2.1</b> Matplotlib Base Plots</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#line-and-scatter-plots"><i class="fa fa-check"></i><b>2.1.1</b> Line and Scatter Plots</a></li>
<li class="chapter" data-level="2.1.2" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#text-plot"><i class="fa fa-check"></i><b>2.1.2</b> Text Plot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="amazon-web-services.html"><a href="amazon-web-services.html"><i class="fa fa-check"></i><b>3</b> Amazon Web Services</a>
<ul>
<li class="chapter" data-level="3.1" data-path="amazon-web-services.html"><a href="amazon-web-services.html#aws-setup"><i class="fa fa-check"></i><b>3.1</b> AWS Setup</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="amazon-web-services.html"><a href="amazon-web-services.html#aws-setup-1"><i class="fa fa-check"></i><b>3.1.1</b> AWS Setup</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="docker-container.html"><a href="docker-container.html"><i class="fa fa-check"></i><b>4</b> Docker Container</a>
<ul>
<li class="chapter" data-level="4.1" data-path="docker-container.html"><a href="docker-container.html#docker-setup"><i class="fa fa-check"></i><b>4.1</b> Docker Setup</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="docker-container.html"><a href="docker-container.html#docker-setup-1"><i class="fa fa-check"></i><b>4.1.1</b> Docker Setup</a></li>
<li class="chapter" data-level="4.1.2" data-path="docker-container.html"><a href="docker-container.html#ecr-setup"><i class="fa fa-check"></i><b>4.1.2</b> ECR Setup</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="get-data.html"><a href="get-data.html"><i class="fa fa-check"></i><b>5</b> Get Data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="get-data.html"><a href="get-data.html#environmental-data"><i class="fa fa-check"></i><b>5.1</b> Environmental Data</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="get-data.html"><a href="get-data.html#ecmwf-era5-data"><i class="fa fa-check"></i><b>5.1.1</b> ECMWF ERA5 Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="system-and-support.html"><a href="system-and-support.html"><i class="fa fa-check"></i><b>6</b> System and Support</a>
<ul>
<li class="chapter" data-level="6.1" data-path="system-and-support.html"><a href="system-and-support.html#command-line"><i class="fa fa-check"></i><b>6.1</b> Command Line</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="system-and-support.html"><a href="system-and-support.html#python-command-line"><i class="fa fa-check"></i><b>6.1.1</b> Python Command Line</a></li>
<li class="chapter" data-level="6.1.2" data-path="system-and-support.html"><a href="system-and-support.html#run-matlab-functions"><i class="fa fa-check"></i><b>6.1.2</b> Run Matlab Functions</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="system-and-support.html"><a href="system-and-support.html#file-in-and-out"><i class="fa fa-check"></i><b>6.2</b> File In and Out</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="system-and-support.html"><a href="system-and-support.html#read-and-write-and-convert"><i class="fa fa-check"></i><b>6.2.1</b> Read and Write and Convert</a></li>
<li class="chapter" data-level="6.2.2" data-path="system-and-support.html"><a href="system-and-support.html#folder-operations"><i class="fa fa-check"></i><b>6.2.2</b> Folder Operations</a></li>
<li class="chapter" data-level="6.2.3" data-path="system-and-support.html"><a href="system-and-support.html#parse-yaml"><i class="fa fa-check"></i><b>6.2.3</b> Parse Yaml</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="system-and-support.html"><a href="system-and-support.html#install-python"><i class="fa fa-check"></i><b>6.3</b> Install Python</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="system-and-support.html"><a href="system-and-support.html#core-installations"><i class="fa fa-check"></i><b>6.3.1</b> Core Installations</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="index-and-code-links.html"><a href="index-and-code-links.html"><i class="fa fa-check"></i><b>A</b> Index and Code Links</a>
<ul>
<li class="chapter" data-level="A.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#array-matrix-dataframe-links"><i class="fa fa-check"></i><b>A.1</b> Array, Matrix, Dataframe links</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.1-arrayarray-links"><i class="fa fa-check"></i><b>A.1.1</b> <span>Section 1.1 Array</span> links</a></li>
<li class="chapter" data-level="A.1.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.2-dictionarydictionary-links"><i class="fa fa-check"></i><b>A.1.2</b> <span>Section 1.2 Dictionary</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#tables-and-graphs-links"><i class="fa fa-check"></i><b>A.2</b> Tables and Graphs links</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.1-matplotlib-base-plotsmatplotlib-base-plots-links"><i class="fa fa-check"></i><b>A.2.1</b> <span>Section 2.1 Matplotlib Base Plots</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#tables-and-graphs-links-1"><i class="fa fa-check"></i><b>A.3</b> Tables and Graphs links</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.1-matplotlib-base-plotsmatplotlib-base-plots-links"><i class="fa fa-check"></i><b>A.3.1</b> <span>Section 3.1 Matplotlib Base Plots</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#amazon-web-services-links"><i class="fa fa-check"></i><b>A.4</b> Amazon Web Services links</a>
<ul>
<li class="chapter" data-level="A.4.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.1-aws-setupaws-setup-links"><i class="fa fa-check"></i><b>A.4.1</b> <span>Section 4.1 AWS Setup</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#docker-container-links"><i class="fa fa-check"></i><b>A.5</b> Docker Container links</a>
<ul>
<li class="chapter" data-level="A.5.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.1-docker-setupdocker-setup-links"><i class="fa fa-check"></i><b>A.5.1</b> <span>Section 5.1 Docker Setup</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="index-and-code-links.html"><a href="index-and-code-links.html#get-data-links"><i class="fa fa-check"></i><b>A.6</b> Get Data links</a>
<ul>
<li class="chapter" data-level="A.6.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-6.1-environmental-dataenvironmental-data-links"><i class="fa fa-check"></i><b>A.6.1</b> <span>Section 6.1 Environmental Data</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.7" data-path="index-and-code-links.html"><a href="index-and-code-links.html#system-and-support-links"><i class="fa fa-check"></i><b>A.7</b> System and Support links</a>
<ul>
<li class="chapter" data-level="A.7.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-7.1-command-linecommand-line-links"><i class="fa fa-check"></i><b>A.7.1</b> <span>Section 7.1 Command Line</span> links</a></li>
<li class="chapter" data-level="A.7.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-7.2-file-in-and-outfile-in-and-out-links"><i class="fa fa-check"></i><b>A.7.2</b> <span>Section 7.2 File In and Out</span> links</a></li>
<li class="chapter" data-level="A.7.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-7.3-install-pythoninstall-python-links"><i class="fa fa-check"></i><b>A.7.3</b> <span>Section 7.3 Install Python</span> links</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://fanwangecon.github.io/pyfan/bookdown/index.html" target="blank">pyfan Bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Collection of Python Examples</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="amazon-web-services" class="section level1" number="3">
<h1><span class="header-section-number">Chapter 3</span> Amazon Web Services</h1>

<div id="aws-setup" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> AWS Setup</h2>

<div id="aws-setup-1" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> AWS Setup</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/pyfan/">Python Code Examples</a> Repository (<a href="https://fanwangecon.github.io/pyfan/bookdown">bookdown site</a>).</p>
</blockquote>
<div id="installation-on-local-machine" class="section level4" number="3.1.1.1">
<h4><span class="header-section-number">3.1.1.1</span> Installation on Local Machine</h4>
<p>First install <a href="https://fanwangecon.github.io/Tex4Econ/nontex/install/windows/fn_installations.html">anaconda, git, and associated programs</a>.</p>
<ol style="list-style-type: decimal">
<li>Putty</li>
<li>access to .pem key</li>
<li>conda aws environment below</li>
</ol>
</div>
<div id="conda-aws-environment" class="section level4" number="3.1.1.2">
<h4><span class="header-section-number">3.1.1.2</span> Conda AWS Environment</h4>
<p>Can Start and Stop instances from Conda Prompt after this.</p>
<pre><code>conda deactivate
conda list env
conda env remove -n wk_aws
conda create -n wk_aws -y
conda activate wk_aws

# Install External Tools
conda install -c anaconda pip -y

# Command line interface
conda install -c conda-forge awscli -y
# Programmatically send JSON instructions with boto3
conda install -c anaconda boto3 -y</code></pre>
</div>
<div id="aws-account-set-up" class="section level4" number="3.1.1.3">
<h4><span class="header-section-number">3.1.1.3</span> AWS Account set-up</h4>
<ol style="list-style-type: decimal">
<li>Sign-up for AWS web services account (can be the same as your Amazon shopping account)</li>
<li>Register for <a href="https://aws.amazon.com/education/awseducate/">AWS Educate</a> to get student or faculty voucher.</li>
</ol>
<ul>
<li>The University of Houston is a part of AWS Educate, choose educator or student, should hear back within 24 hours with coupon code.</li>
<li>UH students can get $100, faculty can get $200.</li>
</ul>
</div>
<div id="start-a-aws-instance-and-link-local-to-remote" class="section level4" number="3.1.1.4">
<h4><span class="header-section-number">3.1.1.4</span> Start a AWS Instance and Link Local to Remote</h4>
<p>Amazon has a lot of tutorials. Here is an outline.</p>
<ol style="list-style-type: decimal">
<li>Generate keypair on AWS, <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html#having-ec2-create-your-key-pair">aws guide</a>
<ul>
<li>this gives you a .pem file which you download and Amazon also remembers</li>
<li>local computers with the right .pem file can talk to your AWS instances</li>
<li>You might need to invoke the chmod command below to set permission:</li>
</ul>
<div class="sourceCode" id="cb34"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb34-1"><a href="amazon-web-services.html#cb34-1" aria-hidden="true"></a><span class="fu">chmod</span> 400 <span class="st">&quot;C:/Users/fan/Documents/Dropbox (UH-ECON)/Programming/AWS/fan_wang-key-pair-us_east_nv.pem&quot;</span></span></code></pre></div></li>
<li><em>Launching Instance</em>: Go to your console, choose EC2, choose launch instance, select Amazon Linux Instance (review and launch)</li>
<li><em>Instance security</em>: select VPC security group: I have for example: fan_wang_SG_us_east_nv_VPC (edit security group and submit)
<ul>
<li>Security group can allow any IP address to access your instance or just specific ones.</li>
<li>AWS has a tool here that just allows your current IP to access the EC2 instance</li>
</ul></li>
<li><em>Instance access key</em>: Select right keypair (your .pem key), fan_wang-key-pair-us_east_nv (prompted after submitting)</li>
<li>For SSH in, you can use Putty. <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/putty.html">aws guide</a>
<ul>
<li>tell Putty your AWS instance DNS address and where your pem key is</li>
<li>Can use a Putty client to enter an EC2 instance</li>
</ul></li>
<li>For SSH, can also do the process below:
<ul>
<li><a href="https://stackoverflow.com/questions/18683092/how-to-run-ssh-add-on-windows">open git bash</a> (install putty before)</li>
</ul>
<div class="sourceCode" id="cb35"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb35-1"><a href="amazon-web-services.html#cb35-1" aria-hidden="true"></a><span class="fu">ssh-agent</span> -s</span>
<span id="cb35-2"><a href="amazon-web-services.html#cb35-2" aria-hidden="true"></a><span class="bu">eval</span> <span class="va">$(</span><span class="fu">ssh-agent</span> -s<span class="va">)</span></span></code></pre></div>
<ul>
<li>Tell SSH where pem key is:</li>
</ul>
<div class="sourceCode" id="cb36"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb36-1"><a href="amazon-web-services.html#cb36-1" aria-hidden="true"></a><span class="fu">ssh-add</span> <span class="st">&quot;C:/Users/fan/Documents/Dropbox (UH-ECON)/Programming/AWS/fan_wang-key-pair-us_east_nv.pem&quot;</span></span></code></pre></div>
<ul>
<li>You will find a public DNS address for your aws instance on the AWS user interface page</li>
</ul>
<div class="sourceCode" id="cb37"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb37-1"><a href="amazon-web-services.html#cb37-1" aria-hidden="true"></a><span class="co"># ssh git bash command line</span></span>
<span id="cb37-2"><a href="amazon-web-services.html#cb37-2" aria-hidden="true"></a><span class="co"># for ubuntu machine</span></span>
<span id="cb37-3"><a href="amazon-web-services.html#cb37-3" aria-hidden="true"></a><span class="fu">ssh</span> ubuntu@ec2-54-197-6-153.compute-1.amazonaws.com</span>
<span id="cb37-4"><a href="amazon-web-services.html#cb37-4" aria-hidden="true"></a><span class="co"># for aws linux</span></span>
<span id="cb37-5"><a href="amazon-web-services.html#cb37-5" aria-hidden="true"></a><span class="fu">ssh</span> ec2-user@ec2-52-23-218-117.compute-1.amazonaws.com</span>
<span id="cb37-6"><a href="amazon-web-services.html#cb37-6" aria-hidden="true"></a><span class="co"># quit aws instance</span></span>
<span id="cb37-7"><a href="amazon-web-services.html#cb37-7" aria-hidden="true"></a><span class="co"># ctrl + D</span></span></code></pre></div>
<ul>
<li>if get: Permission denied (publickey), see:
<ol style="list-style-type: decimal">
<li>Trying to connect with the wrong key. Are you sure this instance is using this keypair?</li>
<li>Trying to connect with the wrong username. ubuntu is the username for the ubuntu based AWS distribution, but on some others it’s ec2-user (or admin on some Debians, according to Bogdan Kulbida’s answer)(can also be root, fedora, see below)</li>
<li>Trying to connect the wrong host. Is that the right host you are trying to log in to?</li>
</ol></li>
<li>You can log in generally like this, note the instance gets new public DNS IP address every time you restart it:</li>
</ul>
<div class="sourceCode" id="cb38"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb38-1"><a href="amazon-web-services.html#cb38-1" aria-hidden="true"></a><span class="va">LOCALPEM=</span><span class="st">&quot;C:/Users/fan/Documents/Dropbox (UH-ECON)/Programming/AWS/fan_wang-key-pair-us_east_nv.pem&quot;</span></span>
<span id="cb38-2"><a href="amazon-web-services.html#cb38-2" aria-hidden="true"></a><span class="va">IPADD=</span>34.207.250.160</span>
<span id="cb38-3"><a href="amazon-web-services.html#cb38-3" aria-hidden="true"></a><span class="va">REMOTEIP=</span>ec2-user<span class="ex">@</span><span class="va">$IPADD</span></span>
<span id="cb38-4"><a href="amazon-web-services.html#cb38-4" aria-hidden="true"></a><span class="fu">ssh-keygen</span> -R <span class="va">$IPADD</span></span>
<span id="cb38-5"><a href="amazon-web-services.html#cb38-5" aria-hidden="true"></a><span class="fu">ssh</span> -i <span class="st">&quot;</span><span class="va">$LOCALPEM</span><span class="st">&quot;</span> <span class="va">$REMOTEIP</span></span></code></pre></div></li>
</ol>
</div>
<div id="use-awscli-to-start-and-stop-an-instance" class="section level4" number="3.1.1.5">
<h4><span class="header-section-number">3.1.1.5</span> Use AWSCLI to Start and Stop an Instance</h4>
<ol style="list-style-type: decimal">
<li>Install AWS CLI</li>
<li>Create individual IAM users</li>
<li><a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-getting-started.html">Configure your awscli</a>
<code>bash     $ aws configure     AWS Access Key ID [None]: XXXXIOSFODNN7EXAMPLE     AWS Secret Access Key [None]: wXalrXXtnXXXX/X7XXXXX/bXxXfiCXXXXXXXXXXX     Default region name [None]: us-west-1     Default output format [None]: json</code></li>
</ol>
<ul>
<li>do not copy and paste the Key ID and Access Key. They are example
<ul>
<li>this creates under a folder like this: C:/Users/fan/.aws, inside the folder these info will be stored in a configuration file.</li>
<li>then when you use aws cli, you will automatically be authenticated</li>
</ul></li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Start an instance in console first (or directly in command line). Stop it. do not terminate. Now this instance will have a fixed instance ID. Its DNS IP address will change every time you restart it, but its instance ID is fixed. Instance ID is found easily in the EC2 Console.
<ul>
<li><a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-ec2-launch.html">Launch an instance</a></li>
</ul>
<div class="sourceCode" id="cb39"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb39-1"><a href="amazon-web-services.html#cb39-1" aria-hidden="true"></a><span class="ex">aws</span> ec2 run-instances --image-id ami-xxxxxxxx --count 1 --instance-type t2.micro --key-name MyKeyPair --security-group-ids sg-xxxxxxxx --subnet-id subnet-xxxxxxxx</span></code></pre></div>
<ul>
<li><a href="https://docs.aws.amazon.com/cli/latest/reference/ec2/start-instances.html">Start</a> an instance</li>
</ul>
<div class="sourceCode" id="cb40"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb40-1"><a href="amazon-web-services.html#cb40-1" aria-hidden="true"></a><span class="ex">aws</span> ec2 start-instances --instance-ids i-XXXXXXXX</span>
<span id="cb40-2"><a href="amazon-web-services.html#cb40-2" aria-hidden="true"></a><span class="ex">aws</span> ec2 start-instances --instance-ids i-040c856530b2619bc</span></code></pre></div>
<ul>
<li><a href="https://docs.aws.amazon.com/cli/latest/reference/ec2/stop-instances.html">Stop</a> an instance</li>
</ul>
<div class="sourceCode" id="cb41"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb41-1"><a href="amazon-web-services.html#cb41-1" aria-hidden="true"></a><span class="ex">aws</span> ec2 stop-instances --instance-ids i-XXXXXXXX</span>
<span id="cb41-2"><a href="amazon-web-services.html#cb41-2" aria-hidden="true"></a><span class="ex">aws</span> ec2 stop-instances --instance-ids i-040c856530b2619bc</span></code></pre></div></li>
</ol>
</div>
<div id="set-up-ssm-on-ec2-instance" class="section level4" number="3.1.1.6">
<h4><span class="header-section-number">3.1.1.6</span> Set-up SSM on EC2 Instance</h4>
<p>To execute commandlines etc remote on EC2, need to set up SSM: AWS Systems Manager Agent (<a href="https://docs.aws.amazon.com/systems-manager/latest/userguide/ssm-agent.html">SSM Agent</a>)</p>
<p>SSM-agent is already installed in Amazon Linux.</p>
<p><a href="https://stackoverflow.com/questions/47034797/invalidinstanceid-an-error-occurred-invalidinstanceid-when-calling-the-sendco">Error Message regarding InvalidInstanceId</a>. The following scenarios can result in this error message:</p>
<ul>
<li>Instance id is invalid (in the comments you have verified it isn’t)</li>
<li>Instance is in a different region (in the comments you have verified it isn’t)</li>
<li>Instance is not currently in the Running state</li>
<li>Instance does not have the AWS SSM agent installed and running.</li>
</ul>
<p>“You have to create and attach the policy AmazonSSMFullAccess to the machine (thats maybe more broad than you need) but that was why it wasn’t working for me… You do that by clicking on (when selected on the ec2 instance) Action &gt; Instance Settings &gt; Attach/Replace IAM Role then create a role for ec2 that has that permission then attach, should take like 5-10 mins to pop up in SYSTEMS MANAGER SHARED RESOURCES - Managed Instances as mark mentions. – Glen Thompson Sep 20 ’18 at 16:31”</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb42-1"><a href="amazon-web-services.html#cb42-1" aria-hidden="true"></a><span class="co"># Start SSM Agent with</span></span>
<span id="cb42-2"><a href="amazon-web-services.html#cb42-2" aria-hidden="true"></a><span class="fu">sudo</span> systemctl start amazon-ssm-agent</span></code></pre></div>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="tables-and-graphs.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="docker-container.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["A-Collection-of-Python-Examples.pdf", "PDF"]],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
